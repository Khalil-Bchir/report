\documentclass{polypfe}
\usepackage[a4paper, margin=1in]{geometry}
\usepackage{titlesec}
\usepackage{enumitem}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{setspace} 
\usepackage{fancyhdr} 
\usepackage{tabularx}
\usepackage{xcolor}
\usepackage{minitoc}
\usepackage{caption}
\usepackage{longtable}
\usepackage{etoc, soul, lipsum}

\hypersetup{
    colorlinks=true,
    linkcolor=black, 
    citecolor=black,
    filecolor=black,
    urlcolor=black
}

\newcommand\mylocaltableofcontents{%
\begingroup
\renewcommand*{\contentsname}{\textcolor{black}{\textbf{Contents}}\\[-1.0em]\color{black}\rule{\textwidth}{1pt}}
\setcounter{secnumdepth}{3} % Number sections and subsections
\etocsettocdepth{3}

\localtableofcontents
\noindent\rule{\textwidth}{1pt}
\endgroup
}

% Define custom colors using hex codes
\definecolor{blue}{HTML}{0039a6}

% Adjust chapter title formatting
\titleformat{\chapter}[display]
{\normalfont\huge\bfseries}{\chaptertitlename\ \thechapter}{20pt}{\Huge}

% Adjust section title formatting
\titleformat{\section}
{\normalfont\Large\bfseries\color{blue}}{\thesection}{1em}{}

% Adjust subsection title formatting
\titleformat{\subsection}
{\normalfont\large\bfseries\color{blue}}{\thesubsection}{1em}{}

% Adjust subsection title formatting
\titleformat{\subsubsection}
{\normalfont\normalsize\bfseries\color{blue}}{\thesubsubsection}{1em}{}


% Adjust itemize and enumerate formatting
\setlist[itemize]{topsep=0pt, partopsep=0pt, left=1em, label=--}
\setlist[enumerate]{topsep=0pt, partopsep=0pt, left=1em, label=\arabic*.}

\fancyhf{}
\renewcommand{\headrulewidth}{0pt}
\fancyhead[L]{%
    \nouppercase{\leftmark}\\ 
    \rule{\textwidth}{0.4pt} 
}
\fancyfoot[R]{%
    \rule{\textwidth}{0.4pt} \\ 
    \thepage  
}

\fancypagestyle{plain}{
  \fancyhf{}%
  \fancyfoot[R]{%
    \rule{\textwidth}{0.4pt} \\ 
    \thepage  
  }%
  \renewcommand{\headrulewidth}{0pt}
}

\geometry{a4paper, margin=1in}

\setcounter{tocdepth}{3} % Show sections
\setcounter{secnumdepth}{3} % Number sections

\begin{document}

\pagestyle{fancy} 

\pagenumbering{roman}

\tableofcontents

\newpage

\listoffigures

\newpage

\listoftables

\newpage

\pagenumbering{arabic}

\input{general-introduction/general introduction.tex}

\setstretch{1.5}

\chapter{General presentation and study of the existing}
\mylocaltableofcontents
\newpage

\input{chapter-1/introduction}
\input{chapter-1/Presentation of the host company}
\input{chapter-1/Project context}
\input{chapter-1/Adopted Methodology}
\input{chapter-1/conclusion}


\chapter{Requirements and specifications}
\mylocaltableofcontents
\newpage

\input{chapter-2/introduction}
\input{chapter-2/Requirements}
\input{chapter-2/Work Environment}
\input{chapter-2/Project Management with Scrum}
%\input{chapter-2/General Architecture of the Application}
%\input{chapter-2/Deployment Diagram}
\input{chapter-2/conclusion}

\end{document}
